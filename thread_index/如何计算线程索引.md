# 如何计算线程索引

调用kernel的时候会传递grid_dim和block_dim进函数

## 一，grid/block一维

在向量加法例子中，每个线程计算一个求和，grid里设置了256个block，每个block设置了4096个thread

```
    dim3 blockSize(256);
    dim3 gridSize((N + blockSize.x - 1) / blockSize.x);
```

index的索引为 `threadIdx.x +blockIdx.x *blockDim.x,`其中threadIdx为每个线程在block中的第几个位置，blockIdx为block在grid中第几个位置，blockDim为block维度大小，如下图所示，黄色位点点线程索引为515
![img](find_index.png)

总结：对于一维<<<grid, block>>>, index=blockIdx.x * blockDim.x + threadIdx.x
